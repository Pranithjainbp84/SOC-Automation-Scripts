import requests
import hashlib

# VirusTotal API key (replace with your actual key)
API_KEY = 'your_api_key_here'

# VirusTotal API URL
VT_URL = 'https://www.virustotal.com/api/v3/files/'

# Function to get file hash
def get_file_hash(file_path):
    sha256_hash = hashlib.sha256()
    with open(file_path, 'rb') as f:
        # Read the file in chunks to avoid memory overload with large files
        for byte_block in iter(lambda: f.read(4096), b""):
            sha256_hash.update(byte_block)
    return sha256_hash.hexdigest()

# Function to check hash against VirusTotal
def check_hash_against_virustotal(file_hash):
    headers = {'x-apikey': API_KEY}
    response = requests.get(f'{VT_URL}{file_hash}', headers=headers)
    if response.status_code == 200:
        result = response.json()
        if result['data']['attributes']['last_analysis_stats']['malicious'] > 0:
            print("Malware detected!")
            print(f"VirusTotal Analysis: {result['data']['attributes']['last_analysis_stats']}")
        else:
            print("File is clean!")
    else:
        print("Error: Unable to fetch data from VirusTotal")

if __name__ == "__main__":
    # Replace with the file you want to check
    file_path = 'path_to_your_file_here'
    file_hash = get_file_hash(file_path)
    print(f"Checking hash for file: {file_path}")
    check_hash_against_virustotal(file_hash)
